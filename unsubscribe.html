<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Unsubscribing… | Friends of Grand Union Canal</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
  body {
    background:#f4f8ff;
    color:#003366;
    font-family:'Segoe UI',Roboto,sans-serif;
    text-align:center;
    margin:0;
    padding:60px 20px;
  }
  .box {
    max-width:480px;
    margin:auto;
    background:#fff;
    border:3px solid #003366;
    border-radius:12px;
    padding:30px 20px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
  }
  .logo {
    width:120px;
    margin-bottom:10px;
  }
  .spinner {
    margin:20px auto;
    width:48px;
    height:48px;
    border:4px solid #d0d8e8;
    border-top:4px solid #003366;
    border-radius:50%;
    animation:spin 1s linear infinite;
  }
  @keyframes spin {0%{transform:rotate(0);}100%{transform:rotate(360deg);}}
</style>
</head>
<body>
  <div class="box">
    <img class="logo" src="https://friendsofgrandunioncanal-coder.github.io/foguc-assets/FoGUC_Logo.png" alt="FoGUC Logo">
    <h2>Unsubscribing…</h2>
    <div class="spinner"></div>
    <p>Please wait while we update your preferences.</p>
  </div>

  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);
      const email = params.get("email") || params.get("unsubscribe");
      if (!email) {
        document.querySelector(".box").innerHTML = `
          <img class="logo" src="https://friendsofgrandunioncanal-coder.github.io/foguc-assets/FoGUC_Logo.png" alt="FoGUC Logo">
          <h2>Oops!</h2>
          <p>No email address found.</p>
          <a href="https://www.friendsofgrandunioncanal.co.uk/welcome"
             style="display:inline-block;margin-top:15px;padding:10px 18px;background:#003366;color:#fff;border-radius:6px;text-decoration:none;font-weight:600;">
             Return to website
          </a>`;
        return;
      }

      const target = "https://script.google.com/macros/s/AKfycbxFYypWfi40gdcrUQamJ0Je3JDYEVT90GTOZelKE3xlPlU9IJyE--IdOoU2xK2hgsbfUg/exec?unsubscribe=" 
                     + encodeURIComponent(email);
      setTimeout(() => window.location.replace(target), 800);
    })();
  </script>
</body>
</html>
